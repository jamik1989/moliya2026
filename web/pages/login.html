<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FORTEL</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    * { box-sizing: border-box; font-family: system-ui; }
    body {
      min-height: 100vh; margin: 0;
      display: flex; align-items: center; justify-content: center;
      background: linear-gradient(135deg, #6a7cff, #8e6cff);
      padding: 18px;
    }
    .login-card {
      width: 100%; max-width: 380px;
      background: #fff; border-radius: 18px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.15);
      padding: 28px;
    }
    .login-title {
      display: flex; align-items: center; gap: 10px;
      font-size: 20px; font-weight: 800; margin-bottom: 18px;
    }
    .form-group { margin-bottom: 14px; }
    .form-input {
      width: 100%; padding: 14px;
      border-radius: 12px; border: 1px solid #ddd;
      font-size: 15px;
    }
    .login-btn {
      width: 100%; padding: 14px;
      border-radius: 14px; border: none;
      background: #4f6ef7; color: #fff;
      font-size: 16px; font-weight: 700;
      cursor: pointer;
    }
    .sub-actions{
      margin-top: 12px;
      display:flex;
      gap:10px;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
      font-size:14px;
    }
    .link-btn{
      border:none;
      background:transparent;
      color:#4f6ef7;
      font-weight:800;
      cursor:pointer;
      padding:0;
      text-decoration: underline;
    }
    .login-msg {
      margin-top: 14px; font-size: 14px;
      text-align: center; display: none;
      padding: 10px; border-radius: 10px;
    }
    .login-msg.error { background: #ffeaea; color: #c0392b; display: block; }
    .login-msg.success { background: #e8f8ef; color: #1e8449; display: block; }
  </style>
</head>

<body>
  <div class="login-card">
    <div class="login-title">
      <i class="fas fa-lock"></i> FORTEL tizimiga kirish
    </div>

    <div class="form-group">
      <input id="username" class="form-input" placeholder="Login">
    </div>

    <div class="form-group">
      <input id="password" type="password" class="form-input" placeholder="Parol">
    </div>

    <button class="login-btn" id="loginBtn">Kirish</button>

    <div class="sub-actions">
      <div>1-marta ishlatyapsizmi?</div>
      <button class="link-btn" id="goRegister" type="button">Ro‘yxatdan o‘tish</button>
    </div>

    <div class="sub-actions">
      <div>Admin kerakmi?</div>
      <button class="link-btn" id="goAdmin" type="button">Admin panel</button>
    </div>

    <div class="login-msg" id="loginMsg"></div>
  </div>

<script>
const API = ""; // same domain

const btn = document.getElementById("loginBtn");
const msg = document.getElementById("loginMsg");

function show(type, text) {
  msg.className = "login-msg " + type;
  msg.textContent = text;
}

document.getElementById("goRegister").onclick = () => location.href = "register.html";
document.getElementById("goAdmin").onclick = () => location.href = "admin.html";

btn.onclick = async () => {
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value;

  if (!username || !password) {
    show("error", "Login va parolni kiriting");
    return;
  }

  try {
    const res = await fetch(API + "/api/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      credentials: "include",
      body: JSON.stringify({ username, password })
    });

    const data = await res.json().catch(() => ({}));
    if (!res.ok) return show("error", data.message || "Xato");

    show("success", "Kirish muvaffaqiyatli");
    setTimeout(() => location.href = "user.html", 250);

  } catch {
    show("error", "Server bilan aloqa yo‘q");
  }
};
</script>
</body>
</html>
