<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FORTEL - Ro‘yxatdan o‘tish</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    * { box-sizing: border-box; font-family: system-ui; }
    body {
      min-height: 100vh; margin: 0;
      display: flex; align-items: center; justify-content: center;
      background: linear-gradient(135deg, #6a7cff, #8e6cff);
      padding: 18px;
    }
    .card {
      width: 100%; max-width: 420px;
      background: #fff; border-radius: 18px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.15);
      padding: 28px;
    }
    .title {
      display:flex; align-items:center; gap:10px;
      font-size: 20px; font-weight: 900;
      margin-bottom: 14px;
    }
    .hint { color:#666; font-size: 14px; margin-bottom: 18px; line-height:1.4; }
    .group { margin-bottom: 12px; }
    .inp{
      width:100%;
      padding: 14px;
      border-radius: 12px;
      border: 1px solid #ddd;
      font-size: 15px;
    }
    .btn{
      width:100%;
      padding: 14px;
      border-radius: 14px;
      border:none;
      background:#4f6ef7;
      color:#fff;
      font-weight:900;
      font-size: 16px;
      cursor:pointer;
    }
    .sub{
      margin-top: 10px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size: 14px;
      flex-wrap:wrap;
      gap:10px;
    }
    .link{
      border:none; background:transparent;
      color:#4f6ef7; font-weight:900;
      cursor:pointer; padding:0;
      text-decoration: underline;
    }
    .msg{
      margin-top: 14px;
      font-size: 14px;
      text-align:center;
      display:none;
      padding: 10px;
      border-radius: 10px;
    }
    .msg.error{ display:block; background:#ffeaea; color:#c0392b; }
    .msg.ok{ display:block; background:#e8f8ef; color:#1e8449; }
  </style>
</head>

<body>
  <div class="card">
    <div class="title">
      <i class="fa-solid fa-user-plus"></i> 1-marta ro‘yxatdan o‘tish
    </div>
    <div class="hint">
      Bu sahifa yangi mijoz uchun: <b>username + parol + telefon</b> bir marta saqlanadi.
      Keyingi safar <b>login</b> sahifasidan kirasiz.
    </div>

    <div class="group">
      <input id="rUser" class="inp" placeholder="Username (faqat harf/son/._-)" />
    </div>
    <div class="group">
      <input id="rPass" type="password" class="inp" placeholder="Parol (min 4)" />
    </div>
    <div class="group">
      <input id="rPhone" class="inp" placeholder="Telefon (misol: +998901112233)" />
    </div>

    <button class="btn" id="regBtn">Saqlash</button>
    <div class="sub">
      <div>Tayyor bo‘ldimi?</div>
      <button class="link" id="goLogin" type="button">Login sahifaga qaytish</button>
    </div>

    <div class="msg" id="regMsg"></div>
  </div>

<script>
const API = "";

const msg = document.getElementById("regMsg");
const btn = document.getElementById("regBtn");
const goLogin = document.getElementById("goLogin");

function show(type, text){
  msg.className = "msg " + type;
  msg.textContent = text;
}

goLogin.onclick = () => location.href = "login.html";

btn.onclick = async () => {
  const username = document.getElementById("rUser").value.trim();
  const password = document.getElementById("rPass").value;
  const phone = document.getElementById("rPhone").value.trim();

  if (!username || !password || !phone) {
    return show("error", "Username, parol va telefonni to‘liq kiriting");
  }
  if (password.length < 4) {
    return show("error", "Parol kamida 4 ta bo‘lsin");
  }

  btn.disabled = true;
  const old = btn.textContent;
  btn.textContent = "Saqlanmoqda...";

  try{
    const res = await fetch(API + "/api/register", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password, phone })
    });

    const data = await res.json().catch(()=> ({}));
    if (!res.ok || !data.ok) {
      return show("error", data.message || "Xato");
    }

    show("ok", data.message || "Saqlanди. Endi login qiling.");
    setTimeout(() => location.href = "login.html", 800);
  }catch(e){
    show("error", "Serverga ulanib bo‘lmadi");
  }finally{
    btn.disabled = false;
    btn.textContent = old;
  }
};
</script>
</body>
</html>
